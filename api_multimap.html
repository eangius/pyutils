<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://eangius.github.io/pyutils/api_multimap.html" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>MultiMap - pyutils</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "MultiMap";
        var mkdocs_page_input_path = "api_multimap.md";
        var mkdocs_page_url = "/pyutils/api_multimap.html";
      </script>
    
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="index.html" class="icon icon-home"> pyutils
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="index.html">About</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">References</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="api_multimap.html">MultiMap</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#pyutils.multimap.MultiMap">MultiMap</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pyutils.multimap.MultiMap.UNDEFINED">UNDEFINED</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pyutils.multimap.MultiMap.domain">domain</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pyutils.multimap.MultiMap.range">range</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pyutils.multimap.MultiMap.__init__">__init__()</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pyutils.multimap.MultiMap.add">add()</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pyutils.multimap.MultiMap.clear">clear()</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pyutils.multimap.MultiMap.copy">copy()</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pyutils.multimap.MultiMap.inverse">inverse()</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pyutils.multimap.MultiMap.items">items()</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pyutils.multimap.MultiMap.remove">remove()</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pyutils.multimap.MultiMap.size">size()</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pyutils.multimap.MultiMap.source">source()</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pyutils.multimap.MultiMap.target">target()</a>
    </li>
    </ul>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyutils</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html" class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">References</li>
      <li class="breadcrumb-item active">MultiMap</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/eangius/pyutils/edit/master/docs/api_multimap.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="multimap">MultiMap</h1>


<div class="doc doc-object doc-class">



<a id="pyutils.multimap.MultiMap"></a>
  <div class="doc doc-contents first">

  
      <p>Mutable collection type that bi-directionally stores mappings
of source &amp; destination items. This type is similar to regular
dictionaries except that it supports having many-to-many
relationships in the collection. This type is also similar to
regular tuple lists with added support for fast indexed lookup
of items by source or destination keys. All source &amp; destinations
must be hashable.</p>
<p>Item storage in internally handled by this class to save memory.
Meaning any dangling source or destination nodes without
relationships are removed from the map. While this type is memory
based, the interface represents an abstraction between function vs
memory mapping implementations. That is, callers need not know
weather a mapping is derived as a computation or lookups. So all
forward &amp; backwards mappings of this type are possible via both
<code>[]</code> indices &amp; <code>()</code> calls.</p>

            <details class="quote">
              <summary>Source code in <code>pyutils/multimap.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MultiMap</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Mutable collection type that bi-directionally stores mappings</span>
<span class="sd">    of source &amp; destination items. This type is similar to regular</span>
<span class="sd">    dictionaries except that it supports having many-to-many</span>
<span class="sd">    relationships in the collection. This type is also similar to</span>
<span class="sd">    regular tuple lists with added support for fast indexed lookup</span>
<span class="sd">    of items by source or destination keys. All source &amp; destinations</span>
<span class="sd">    must be hashable.</span>

<span class="sd">    Item storage in internally handled by this class to save memory.</span>
<span class="sd">    Meaning any dangling source or destination nodes without</span>
<span class="sd">    relationships are removed from the map. While this type is memory</span>
<span class="sd">    based, the interface represents an abstraction between function vs</span>
<span class="sd">    memory mapping implementations. That is, callers need not know</span>
<span class="sd">    weather a mapping is derived as a computation or lookups. So all</span>
<span class="sd">    forward &amp; backwards mappings of this type are possible via both</span>
<span class="sd">    ``[]`` indices &amp; ``()`` calls.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Relation</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor to instantiate an new ``MultiMap``.</span>

<span class="sd">        Args:</span>
<span class="sd">            items: Optional collection of source &amp; destination nodes to map.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1"># outgoing frequencies</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1"># incoming frequencies</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_items</span> <span class="o">=</span> <span class="kc">None</span>      <span class="c1"># state of iteration</span>
        <span class="k">for</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span> <span class="ow">in</span> <span class="n">items</span> <span class="ow">or</span> <span class="p">[]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span> <span class="nf">UNDEFINED</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Readonly unique symbol denoting &quot;no-value&quot; of node so that</span>
<span class="sd">        ``None`` values can be handled in mapping.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">object</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">domain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="n">Node</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the current set of distinct source nodes of this map.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">range</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="n">Node</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the current set of distinct target nodes of this map.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Relation</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the current collection of source &amp; destination relations in this map.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">src</span><span class="p">,</span> <span class="n">ctr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">dst</span><span class="p">,</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">ctr</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Node</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Forward maps from a specific source node &amp; returns its collection</span>
<span class="sd">        of related target nodes if any or empty otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">dst</span>
            <span class="k">for</span> <span class="n">dst</span><span class="p">,</span> <span class="n">freq</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="nb">dict</span><span class="p">())</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dst</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Node</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Backwards maps from a specific target node &amp; returns its collection</span>
<span class="sd">        of related source nodes if any or empty otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">src</span>
            <span class="k">for</span> <span class="n">src</span><span class="p">,</span> <span class="n">freq</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="nb">dict</span><span class="p">())</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of relationships in this map.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>  <span class="c1"># unfolded out</span>

    <span class="k">def</span> <span class="nf">inverse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MultiMap&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reverses source &amp; destination direction mapping of all</span>
<span class="sd">        relationships in this map.</span>

<span class="sd">        Args:</span>
<span class="sd">            copy: To perform operation in new map or in place.</span>

<span class="sd">        Returns:</span>
<span class="sd">            result: A mapping with source &amp; destination nodes reversed.</span>
<span class="sd">                Same instance whenever ``copy=False``</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">copy</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">MultiMap</span><span class="p">(</span>
                <span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span> <span class="ow">in</span> <span class="bp">self</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src</span><span class="p">:</span> <span class="n">Node</span><span class="p">,</span> <span class="n">dst</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MultiMap&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Inplace inserts a specific relationship to this map even if</span>
<span class="sd">        an identical one already exists.</span>

<span class="sd">        Args:</span>
<span class="sd">            src: Source node</span>
<span class="sd">            dst: Destination node</span>

<span class="sd">        Returns:</span>
<span class="sd">            result: Modified instance of this map.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">src</span> <span class="o">!=</span> <span class="n">MultiMap</span><span class="o">.</span><span class="n">UNDEFINED</span> <span class="ow">and</span> <span class="n">dst</span> <span class="o">!=</span> <span class="n">MultiMap</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">Counter</span><span class="p">())</span><span class="o">.</span><span class="n">update</span><span class="p">([</span><span class="n">dst</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">Counter</span><span class="p">())</span><span class="o">.</span><span class="n">update</span><span class="p">([</span><span class="n">src</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src</span><span class="p">:</span> <span class="n">Node</span><span class="p">,</span> <span class="n">dst</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MultiMap&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Inplace deletes specific relationships from this map.</span>
<span class="sd">        When multiple identical relationships exists, only 1 is removed.</span>
<span class="sd">        No effect if the relationship does not exists.</span>

<span class="sd">        Args:</span>
<span class="sd">            src: Source node. Removes all mappings from a destination when it is ``MultiMap.UNDEFINED``</span>
<span class="sd">            dst: Destination node. Removes all mappings from a source when it is ``MultiMap.UNDEFINED``</span>

<span class="sd">        Returns:</span>
<span class="sd">            result: Modified instance of this map.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__delitem__</span><span class="p">((</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MultiMap&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Inplace deletes all relationships in this map.</span>

<span class="sd">        Returns:</span>
<span class="sd">            result: Modified instance of this map.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MultiMap&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a new but shallow clone of this mapping.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">MultiMap</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="c1"># visually represent state of this map.</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

    <span class="c1"># number &amp; frequency of relationships match another</span>
    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;MultiMap&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> \
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span> <span class="ow">and</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_sources</span> <span class="ow">and</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_targets</span>

    <span class="c1"># union as new mapping of this &amp; another collection</span>
    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;MultiMap&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MultiMap&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">result</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">*</span><span class="n">item</span><span class="p">),</span>
            <span class="n">other</span><span class="p">,</span>
            <span class="n">MultiMap</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="c1"># difference as new mapping of this &amp; other collection</span>
    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;MultiMap&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MultiMap&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">result</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="o">*</span><span class="n">item</span><span class="p">),</span>
            <span class="n">other</span><span class="p">,</span>
            <span class="n">MultiMap</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="c1"># identify if specific source to destination mapping exists.</span>
    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">Relation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">src</span><span class="p">,</span> <span class="n">dst</span> <span class="o">=</span> <span class="n">item</span>
        <span class="n">in_src</span> <span class="o">=</span> <span class="n">src</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span>
        <span class="n">in_dst</span> <span class="o">=</span> <span class="n">dst</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span>
        <span class="k">return</span> \
            <span class="n">in_src</span> <span class="k">if</span> <span class="n">src</span> <span class="o">!=</span> <span class="n">MultiMap</span><span class="o">.</span><span class="n">UNDEFINED</span> <span class="ow">and</span> <span class="n">dst</span> <span class="o">==</span> <span class="n">MultiMap</span><span class="o">.</span><span class="n">UNDEFINED</span> <span class="k">else</span> \
            <span class="n">in_dst</span> <span class="k">if</span> <span class="n">src</span> <span class="o">==</span> <span class="n">MultiMap</span><span class="o">.</span><span class="n">UNDEFINED</span> <span class="ow">and</span> <span class="n">dst</span> <span class="o">!=</span> <span class="n">MultiMap</span><span class="o">.</span><span class="n">UNDEFINED</span> <span class="k">else</span> \
            <span class="n">in_src</span> <span class="ow">and</span> <span class="n">in_dst</span>

    <span class="c1"># remove explicit relation or groups or relations.</span>
    <span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">Relation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MultiMap&#39;</span><span class="p">:</span>
        <span class="n">src</span><span class="p">,</span> <span class="n">dst</span> <span class="o">=</span> <span class="n">item</span>

        <span class="k">if</span> <span class="n">src</span> <span class="o">!=</span> <span class="n">MultiMap</span><span class="o">.</span><span class="n">UNDEFINED</span> <span class="ow">and</span> <span class="n">dst</span> <span class="o">!=</span> <span class="n">MultiMap</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_decrement_frequency</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_decrement_frequency</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">if</span> <span class="n">src</span> <span class="o">!=</span> <span class="n">MultiMap</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">dst</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">[</span><span class="n">src</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_decrement_frequency</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">)</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">[</span><span class="n">src</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">if</span> <span class="n">dst</span> <span class="o">!=</span> <span class="n">MultiMap</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="p">[</span><span class="n">dst</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_decrement_frequency</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="p">[</span><span class="n">dst</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="fm">__len__</span> <span class="o">=</span> <span class="n">size</span>          <span class="c1"># cardinality</span>
    <span class="fm">__iter__</span> <span class="o">=</span> <span class="n">items</span>        <span class="c1"># iterable like list</span>
    <span class="fm">__getitem__</span> <span class="o">=</span> <span class="n">source</span>    <span class="c1"># syntactic sugar idexable like list</span>
    <span class="fm">__call__</span> <span class="o">=</span> <span class="n">source</span>       <span class="c1"># syntactic sugar callable like function</span>

    <span class="c1"># ensure source/target keys are removed when no longer linked.</span>
    <span class="c1"># returns true if freq dictionary was modified.</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_decrement_frequency</span><span class="p">(</span><span class="n">freq</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">freq</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">freq</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-=</span> <span class="n">Counter</span><span class="p">([</span><span class="n">v</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">freq</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">Counter</span><span class="p">():</span>
            <span class="k">del</span> <span class="n">freq</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h2 id="pyutils.multimap.MultiMap.UNDEFINED" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">UNDEFINED</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h2>


  <div class="doc doc-contents ">
  
      <p>Readonly unique symbol denoting "no-value" of node so that
<code>None</code> values can be handled in mapping.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h2 id="pyutils.multimap.MultiMap.domain" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">domain</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">Node</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h2>


  <div class="doc doc-contents ">
  
      <p>Retrieves the current set of distinct source nodes of this map.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h2 id="pyutils.multimap.MultiMap.range" class="doc doc-heading">
          <code class="highlight language-python"><span class="nb">range</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">Node</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h2>


  <div class="doc doc-contents ">
  
      <p>Retrieves the current set of distinct target nodes of this map.</p>
  </div>

</div>




<div class="doc doc-object doc-function">




<h2 id="pyutils.multimap.MultiMap.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Constructor to instantiate an new <code>MultiMap</code>.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>items</code></b>
                  (<code><span title="typing.Iterable">Iterable</span>[<span title="pyutils.multimap.Relation">Relation</span>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Optional collection of source &amp; destination nodes to map.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
          <details class="quote">
            <summary>Source code in <code>pyutils/multimap.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Relation</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor to instantiate an new ``MultiMap``.</span>

<span class="sd">    Args:</span>
<span class="sd">        items: Optional collection of source &amp; destination nodes to map.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1"># outgoing frequencies</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1"># incoming frequencies</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_items</span> <span class="o">=</span> <span class="kc">None</span>      <span class="c1"># state of iteration</span>
    <span class="k">for</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span> <span class="ow">in</span> <span class="n">items</span> <span class="ow">or</span> <span class="p">[]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="pyutils.multimap.MultiMap.add" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">add</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Inplace inserts a specific relationship to this map even if
an identical one already exists.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>src</code></b>
                  (<code><span title="pyutils.multimap.Node">Node</span></code>)
              –
              <div class="doc-md-description">
                <p>Source node</p>
              </div>
            </li>
            <li>
              <b><code>dst</code></b>
                  (<code><span title="pyutils.multimap.Node">Node</span></code>)
              –
              <div class="doc-md-description">
                <p>Destination node</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
      <ul class="first simple">
          <li>
<b><code>result</code></b>(                <code><a class="autorefs autorefs-internal" title="pyutils.multimap.MultiMap" href="#pyutils.multimap.MultiMap">MultiMap</a></code>
)            –
            <div class="doc-md-description">
              <p>Modified instance of this map.</p>
            </div>
          </li>
      </ul>
    </td>
    </tr>
  </tbody>
</table>
          <details class="quote">
            <summary>Source code in <code>pyutils/multimap.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src</span><span class="p">:</span> <span class="n">Node</span><span class="p">,</span> <span class="n">dst</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MultiMap&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Inplace inserts a specific relationship to this map even if</span>
<span class="sd">    an identical one already exists.</span>

<span class="sd">    Args:</span>
<span class="sd">        src: Source node</span>
<span class="sd">        dst: Destination node</span>

<span class="sd">    Returns:</span>
<span class="sd">        result: Modified instance of this map.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">src</span> <span class="o">!=</span> <span class="n">MultiMap</span><span class="o">.</span><span class="n">UNDEFINED</span> <span class="ow">and</span> <span class="n">dst</span> <span class="o">!=</span> <span class="n">MultiMap</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">Counter</span><span class="p">())</span><span class="o">.</span><span class="n">update</span><span class="p">([</span><span class="n">dst</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">Counter</span><span class="p">())</span><span class="o">.</span><span class="n">update</span><span class="p">([</span><span class="n">src</span><span class="p">])</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="pyutils.multimap.MultiMap.clear" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">clear</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Inplace deletes all relationships in this map.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
      <ul class="first simple">
          <li>
<b><code>result</code></b>(                <code><a class="autorefs autorefs-internal" title="pyutils.multimap.MultiMap" href="#pyutils.multimap.MultiMap">MultiMap</a></code>
)            –
            <div class="doc-md-description">
              <p>Modified instance of this map.</p>
            </div>
          </li>
      </ul>
    </td>
    </tr>
  </tbody>
</table>
          <details class="quote">
            <summary>Source code in <code>pyutils/multimap.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MultiMap&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Inplace deletes all relationships in this map.</span>

<span class="sd">    Returns:</span>
<span class="sd">        result: Modified instance of this map.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="pyutils.multimap.MultiMap.copy" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">copy</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Creates a new but shallow clone of this mapping.</p>

          <details class="quote">
            <summary>Source code in <code>pyutils/multimap.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MultiMap&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a new but shallow clone of this mapping.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">MultiMap</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="pyutils.multimap.MultiMap.inverse" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">inverse</span><span class="p">(</span><span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Reverses source &amp; destination direction mapping of all
relationships in this map.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>copy</code></b>
                  (<code>bool</code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>To perform operation in new map or in place.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
      <ul class="first simple">
          <li>
<b><code>result</code></b>(                <code><a class="autorefs autorefs-internal" title="pyutils.multimap.MultiMap" href="#pyutils.multimap.MultiMap">MultiMap</a></code>
)            –
            <div class="doc-md-description">
              <p>A mapping with source &amp; destination nodes reversed.
Same instance whenever <code>copy=False</code></p>
            </div>
          </li>
      </ul>
    </td>
    </tr>
  </tbody>
</table>
          <details class="quote">
            <summary>Source code in <code>pyutils/multimap.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">inverse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MultiMap&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reverses source &amp; destination direction mapping of all</span>
<span class="sd">    relationships in this map.</span>

<span class="sd">    Args:</span>
<span class="sd">        copy: To perform operation in new map or in place.</span>

<span class="sd">    Returns:</span>
<span class="sd">        result: A mapping with source &amp; destination nodes reversed.</span>
<span class="sd">            Same instance whenever ``copy=False``</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">copy</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">MultiMap</span><span class="p">(</span>
            <span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span> <span class="ow">in</span> <span class="bp">self</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="pyutils.multimap.MultiMap.items" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">items</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Retrieves the current collection of source &amp; destination relations in this map.</p>

          <details class="quote">
            <summary>Source code in <code>pyutils/multimap.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Relation</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves the current collection of source &amp; destination relations in this map.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">src</span><span class="p">,</span> <span class="n">ctr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">dst</span><span class="p">,</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">ctr</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="pyutils.multimap.MultiMap.remove" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">remove</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Inplace deletes specific relationships from this map.
When multiple identical relationships exists, only 1 is removed.
No effect if the relationship does not exists.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>src</code></b>
                  (<code><span title="pyutils.multimap.Node">Node</span></code>)
              –
              <div class="doc-md-description">
                <p>Source node. Removes all mappings from a destination when it is <code>MultiMap.UNDEFINED</code></p>
              </div>
            </li>
            <li>
              <b><code>dst</code></b>
                  (<code><span title="pyutils.multimap.Node">Node</span></code>)
              –
              <div class="doc-md-description">
                <p>Destination node. Removes all mappings from a source when it is <code>MultiMap.UNDEFINED</code></p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
      <ul class="first simple">
          <li>
<b><code>result</code></b>(                <code><a class="autorefs autorefs-internal" title="pyutils.multimap.MultiMap" href="#pyutils.multimap.MultiMap">MultiMap</a></code>
)            –
            <div class="doc-md-description">
              <p>Modified instance of this map.</p>
            </div>
          </li>
      </ul>
    </td>
    </tr>
  </tbody>
</table>
          <details class="quote">
            <summary>Source code in <code>pyutils/multimap.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src</span><span class="p">:</span> <span class="n">Node</span><span class="p">,</span> <span class="n">dst</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MultiMap&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Inplace deletes specific relationships from this map.</span>
<span class="sd">    When multiple identical relationships exists, only 1 is removed.</span>
<span class="sd">    No effect if the relationship does not exists.</span>

<span class="sd">    Args:</span>
<span class="sd">        src: Source node. Removes all mappings from a destination when it is ``MultiMap.UNDEFINED``</span>
<span class="sd">        dst: Destination node. Removes all mappings from a source when it is ``MultiMap.UNDEFINED``</span>

<span class="sd">    Returns:</span>
<span class="sd">        result: Modified instance of this map.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__delitem__</span><span class="p">((</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="pyutils.multimap.MultiMap.size" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">size</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Number of relationships in this map.</p>

          <details class="quote">
            <summary>Source code in <code>pyutils/multimap.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Number of relationships in this map.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>  <span class="c1"># unfolded out</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="pyutils.multimap.MultiMap.source" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">source</span><span class="p">(</span><span class="n">src</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Forward maps from a specific source node &amp; returns its collection
of related target nodes if any or empty otherwise.</p>

          <details class="quote">
            <summary>Source code in <code>pyutils/multimap.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Node</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Forward maps from a specific source node &amp; returns its collection</span>
<span class="sd">    of related target nodes if any or empty otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">dst</span>
        <span class="k">for</span> <span class="n">dst</span><span class="p">,</span> <span class="n">freq</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="nb">dict</span><span class="p">())</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="pyutils.multimap.MultiMap.target" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">target</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Backwards maps from a specific target node &amp; returns its collection
of related source nodes if any or empty otherwise.</p>

          <details class="quote">
            <summary>Source code in <code>pyutils/multimap.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dst</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Node</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Backwards maps from a specific target node &amp; returns its collection</span>
<span class="sd">    of related source nodes if any or empty otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">src</span>
        <span class="k">for</span> <span class="n">src</span><span class="p">,</span> <span class="n">freq</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="nb">dict</span><span class="p">())</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="index.html" class="btn btn-neutral float-left" title="About"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="examples.html" class="btn btn-neutral float-right" title="Examples">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>Copyright &copy; <a href="https://github.com/eangius">eangius</a>.</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/eangius/pyutils/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="index.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="examples.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="js/jquery-3.6.0.min.js"></script>
    <script>var base_url = ".";</script>
    <script src="js/theme_extra.js"></script>
    <script src="js/theme.js"></script>
      <script src="search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
